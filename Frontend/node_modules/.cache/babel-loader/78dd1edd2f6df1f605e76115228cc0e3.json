{"ast":null,"code":"var _jsxFileName = \"D:\\\\hihi\\\\senior-project\\\\web\\\\src\\\\components\\\\Header\\\\Notification.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport notiApi from \"api/notiApi\";\nimport { formatDateTime } from \"lib/Helper\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { IoMdNotifications } from \"react-icons/io\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Notification(props) {\n  _s();\n\n  const [show, setShow] = useState(false);\n  const [listNoti, setListNoti] = useState([]);\n  const [updateNoti, setUpdateNoti] = useState(true);\n  const wrapperRef = useRef(null);\n  useOutsideAlerter(wrapperRef, () => {\n    setShow(false);\n  });\n\n  const handleShow = () => {\n    if (show) {\n      setShow(false);\n    } else {\n      setShow(true);\n    }\n  };\n\n  const handleRead = item => {\n    listNoti.forEach(element => {\n      if (element.id === item.id) {\n        element.readed = true;\n      }\n    });\n    notiApi.readNoti({\n      id: item.id\n    });\n    setListNoti([...listNoti]);\n    setShow(false);\n  };\n\n  useEffect(() => {// if (!listNoti.length) {\n    //   notiApi.getAllNoti().then((res) => {\n    //     setListNoti(res);\n    //   });\n    // }\n    // if (updateNoti) {\n    //   setUpdateNoti(false);\n    //   const interval = setInterval(() => {\n    //     notiApi.getAllNoti().then((res) => {\n    //       setListNoti(res);\n    //     });\n    //   }, 10000);\n    //   return  () => clearInterval(interval);\n    // }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: wrapperRef,\n    className: \"me-2 nav-item dropdown\",\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"dropdown-toggle nav-link cursor--pointer\",\n      onClick: handleShow,\n      children: [/*#__PURE__*/_jsxDEV(IoMdNotifications, {\n        className: \"icon fs--1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this), (() => {\n        const len = listNoti.filter(item => {\n          return item.readed === false;\n        }).length || 0;\n        return len ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"noti--unread\",\n          children: len\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 23\n        }, this) : null;\n      })()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `dropdown-menu dropdown-menu-light ${show ? \"show\" : \"\"}`,\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        id: \"noti\",\n        children: listNoti.length ? listNoti.map((item, index) => {\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            className: `noti ${item.readed ? \"\" : \"not-read\"}`,\n            onClick: () => {\n              handleRead(item);\n            },\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              draggable: \"false\",\n              to: item.link,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"noti__avatar\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: item.imgLink,\n                    alt: \"from avatar\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 80,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 79,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"noti__desc\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"noti__desc--tittle\",\n                    children: item.title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 83,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"noti__desc--content\",\n                    children: item.content\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 84,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"noti__desc--time\",\n                    children: formatDateTime(item.createTime, true)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 85,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 82,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 78,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 19\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 17\n          }, this);\n        }) : /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"text-center d-block\",\n          children: \"Kh\\xF4ng c\\xF3 th\\xF4ng b\\xE1o n\\xE0o\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Notification, \"XyzyY5/W7d9KxfX4S1PEh5qnrus=\", false, function () {\n  return [useOutsideAlerter];\n});\n\n_c = Notification;\nexport default _c2 = /*#__PURE__*/React.memo(Notification);\n\nfunction useOutsideAlerter(ref, callback) {\n  _s2();\n\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (ref.current && !ref.current.contains(event.target)) {\n        callback();\n      }\n    }\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [ref]);\n}\n\n_s2(useOutsideAlerter, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Notification\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["D:/hihi/senior-project/web/src/components/Header/Notification.jsx"],"names":["notiApi","formatDateTime","React","useEffect","useRef","useState","IoMdNotifications","Link","Notification","props","show","setShow","listNoti","setListNoti","updateNoti","setUpdateNoti","wrapperRef","useOutsideAlerter","handleShow","handleRead","item","forEach","element","id","readed","readNoti","len","filter","length","map","index","link","imgLink","title","content","createTime","memo","ref","callback","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import notiApi from \"api/notiApi\";\r\nimport { formatDateTime } from \"lib/Helper\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { IoMdNotifications } from \"react-icons/io\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Notification(props) {\r\n  const [show, setShow] = useState(false);\r\n  const [listNoti, setListNoti] = useState([]);\r\n  const [updateNoti, setUpdateNoti] = useState(true);\r\n  const wrapperRef = useRef(null);\r\n  useOutsideAlerter(wrapperRef, () => {\r\n    setShow(false);\r\n  });\r\n  const handleShow = () => {\r\n    if (show) {\r\n      setShow(false);\r\n    } else {\r\n      setShow(true);\r\n    }\r\n  };\r\n  const handleRead = (item) => {\r\n    listNoti.forEach((element) => {\r\n      if (element.id === item.id) {\r\n        element.readed = true;\r\n      }\r\n    });\r\n    notiApi.readNoti({ id: item.id });\r\n    setListNoti([...listNoti]);\r\n    setShow(false);\r\n  };\r\n  useEffect(() => {\r\n    // if (!listNoti.length) {\r\n    //   notiApi.getAllNoti().then((res) => {\r\n    //     setListNoti(res);\r\n    //   });\r\n    // }\r\n    // if (updateNoti) {\r\n    //   setUpdateNoti(false);\r\n    //   const interval = setInterval(() => {\r\n    //     notiApi.getAllNoti().then((res) => {\r\n    //       setListNoti(res);\r\n    //     });\r\n    //   }, 10000);\r\n    //   return  () => clearInterval(interval);\r\n    // }\r\n  }, []);\r\n  return (\r\n    <div ref={wrapperRef} className=\"me-2 nav-item dropdown\">\r\n      <span\r\n        className=\"dropdown-toggle nav-link cursor--pointer\"\r\n        onClick={handleShow}\r\n      >\r\n        <IoMdNotifications className=\"icon fs--1\" />\r\n        {(() => {\r\n          const len =\r\n            listNoti.filter((item) => {\r\n              return item.readed === false;\r\n            }).length || 0;\r\n          return (len?<span className=\"noti--unread\">{len}</span>:null)\r\n        })()}\r\n      </span>\r\n      <div\r\n        className={`dropdown-menu dropdown-menu-light ${show ? \"show\" : \"\"}`}\r\n      >\r\n        <ul id=\"noti\">\r\n          {listNoti.length ? (\r\n            listNoti.map((item, index) => {\r\n              return (\r\n                <li\r\n                  key={index}\r\n                  className={`noti ${item.readed ? \"\" : \"not-read\"}`}\r\n                  onClick={() => {\r\n                    handleRead(item);\r\n                  }}\r\n                >\r\n                  <Link draggable=\"false\" to={item.link}>\r\n                    <div className=\"d-flex\">\r\n                      <div className=\"noti__avatar\">\r\n                        <img src={item.imgLink} alt=\"from avatar\" />\r\n                      </div>\r\n                      <div className=\"noti__desc\">\r\n                        <p className=\"noti__desc--tittle\">{item.title}</p>\r\n                        <p className=\"noti__desc--content\">{item.content}</p>\r\n                        <p className=\"noti__desc--time\">\r\n                          {formatDateTime(item.createTime, true)}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </Link>\r\n                </li>\r\n              );\r\n            })\r\n          ) : (\r\n            <li className=\"text-center d-block\">Không có thông báo nào</li>\r\n          )}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default React.memo(Notification);\r\n\r\nfunction useOutsideAlerter(ref, callback) {\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (ref.current && !ref.current.contains(event.target)) {\r\n        callback();\r\n      }\r\n    }\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    };\r\n  }, [ref]);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}